union-find 알고리즘으로 푸는게 가능합니다.   
추후에 MST(최소 신장 트리)를 크루스칼 알고리즘으로 구현하는 방법을 공부할때 다시 풀어보면 좋을거 같습니다.   